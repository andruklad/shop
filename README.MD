# Shop

Version: 4.0.

Author: Andrei Kladkevich

2024

## Бизнес-требования.

Version: 1.0.
Реализовать веб-приложение - прототип для интернет-магазина.

Сущности:
1. Каталог категорий товаров:
- код;
- наименование.
2. Категория товаров:
- код;
- наименование;
- код каталога.
3. Товар:
- артикль;
- наименование;
- цена;
- код категори.

Бизнес-действия.
1. Добавление каталога в хранилище.
2. Добавление категории в каталог.
3. Добавление товара в категорию.
4. Поиск товара с максимальной ценой.
5. Получение содержимого категории.
6. Получение содержимого каталога.
7. Получение содержимого всех каталогов.

Version: 2.0.
Реализовать хранение сущностей в БД через Hibernate и/или JdbcTemplate.

Version: 3.0.
Для работы с БД использовать Spring Data JPA.

Version 4.0.
Настроить миграции через liquibase.
Подключить к проекту Redis.

Version 5.0.
1. Поправить тест contextLoads - должен проходить независимо от БД приложения
(можно использовать h2).
2. Покрыть тестами контроллеры.
3. Завести в сервис пользователей, добавить ролевую модель и разграничение
   доступа согласно этой модели.

## Реализация.

### Пояснения
Version: 1.0.
1. Отсутствует поддержка вторичных ключей между сущностями (подразумевается, что в перспективе ограничения будут реализованы на уровне БД).
2. Обработана небольшая часть неосновных юзкейсов (поиск и удаление несуществующего товара, категории и т.д.).

Version: 2.0.
1. Реализовано хранение сущностей в БД Postgres.
2. Оставлена возможность хранения сущностей в памяти.
Для настройки режима используется свойство repository.mode.
Варианты значений:
- memory - работа с памятью;
- postgres - работа с БД Postgres.
3. Добавлен скрипт для создания объектов в БД: script.sql.
4. Для работы с сущностью Catalog использован JdbcTemplate.
5. Для работы с сущностями Category и Product использован Hibernate.

Version 2.1.
Удалена поддержка работы с памятью.

Version 4.0.
Настроена миграция через liquibase.
Задействовано кеширование поиска каталога по коду.

Version 5.0.
1. Отдельно сконфигурирована тестовая среда, с использованием БД h2.
2. Покрыт тестами контроллер каталогов.
3. Добавлено ведение пользователей, ролевая модель и разграничение доступа с использованием spring-boot-starter-security.
Пользователи: user/user с ролью USER, admin/admin с ролью ADMIN.
Разграничение прав:
- без авторизации: получение данных (метод GET);
- роль USER: создание записей (метод POST);
- роль ADMIN: обновление и удаление записей (методы PUT и GET).